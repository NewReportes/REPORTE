<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reporte detalle encuesta</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h1 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .total {
      font-weight: bold;
      text-align: right;
    }
  </style>
</head>
<body>

  <h1>Logo</h1>

  <p><strong>Fecha del Reporte:</strong> <span id="fechaReporte"></span></p>

  <h2>RESUMEN GENERAL.</h2>

  <table>
    <thead>
      <tr>
        <th>Total de Ventas</th>
        <th>Cantidad de Productos Vendidos</th>
        <th>Ingresos Totales</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="cumplimientoac"></td>
        <td id="cantidad"></td>
        <td id="Total"></td>
      </tr>
    </tbody>
  </table>

  <h2>Detalle de Venta</h2>

  <table>
    <thead>
      <tr>
        <th>ID Encuesta</th>
        <th>Categoria</th>
        <th>Cantespcolg</th>
        <th>CantespElmex</th>
        <th>cumplimiento</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody id="detalleVenta">
      <!-- Aquí se insertarán las filas del detalle de venta -->
    </tbody>
  </table>

  <p class="total"><strong>Total General:</strong> <span id="totalGeneral"></span></p>

  <script>
    // Función para obtener el parámetro 'fecha' de la URL
    function obtenerFechaDeURL() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('fecha');
    }

    // Obtener la fecha del parámetro de la URL
    const fechaParametro = obtenerFechaDeURL();

    // Mostrar la fecha en el reporte (si existe)
    if (fechaParametro) {
      document.getElementById('fechaReporte').textContent = fechaParametro;
    } else {
      document.getElementById('fechaReporte').textContent = 'No especificada';
    }


    // Datos de ejemplo (reemplazar con datos reales)
    const datosVenta = {
      cumplimientoac: 20,
      cantidad: 43,
      Total: 1200,
      detalle: [
        { idVenta: 1, producto: 'Camiseta', cantidad: 2, precioUnitario: 20, fechaVenta: '2023-10-26' },
        { idVenta: 2, producto: 'Pantalón', cantidad: 1, precioUnitario: 40, fechaVenta: '2023-10-26' },
        { idVenta: 3, producto: 'Zapatos', cantidad: 1, precioUnitario: 60, fechaVenta: '2023-10-26' },
        { idVenta: 4, producto: 'Gorra', cantidad: 3, precioUnitario: 15, fechaVenta: '2023-10-26' },
        { idVenta: 5, producto: 'Calcetines', cantidad: 5, precioUnitario: 5, fechaVenta: '2023-10-26' },
      ]
    };


    // Llenar el resumen de venta
    document.getElementById('cumplimientoac').innerHTML = datosVenta.cumplimientoac;
    document.getElementById('cantidad').innerHTML = datosVenta.cantidad;
    document.getElementById('Total').innerHTML = datosVenta.Total;

    // Llenar el detalle de venta
    const detalleVentaTabla = document.getElementById('detalleVenta');
    let totalGeneral = 0; // Inicializar el total general

    datosVenta.detalle.forEach(venta => {
      const subtotal = venta.cantidad * venta.precioUnitario;
      totalGeneral += subtotal; // Acumular el subtotal al total general
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${venta.idVenta}</td>
        <td>${venta.producto}</td>
        <td>${venta.cantidad}</td>
        <td>${venta.precioUnitario}</td>
        <td>${subtotal}</td>
        <td>${venta.fechaVenta}</td>
      `;
      detalleVentaTabla.appendChild(row);
    });

    // Mostrar el total general
    document.getElementById('totalGeneral').textContent = totalGeneral;
  </script>

</body>
</html>
