<!DOCTYPE html>
<html>
<head>
  <title>Reporte de Venta</title>
  <style>
    body {
      font-family: sans-serif;
    }
    .container {
      width: 80%;
      margin: 20px auto;
      border: 1px solid #ccc;
      padding: 20px;
    }
    .venta-header {
      background-color: #f0f0f0;
      padding: 10px;
      margin-bottom: 20px;
      text-align: center;
    }
    .venta-info {
      margin-bottom: 10px;
    }
    .detalle-table {
      width: 100%;
      border-collapse: collapse;
    }
    .detalle-table th, .detalle-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    .detalle-table th {
      background-color: #eee;
    }
    .total {
      font-weight: bold;
      text-align: right;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="venta-header">
      <h1>Reporte de Venta</h1>
    </div>

    <div class="venta-info">
      <strong>ID de Venta:</strong> <span id="venta-id">&gt;&gt;[ID_encuesta]&gt;&gt;</span><br>
      <strong>Fecha:</strong> <span id="venta-fecha">&gt;&gt;[FECHA]&gt;&gt;</span><br>
      <strong>Local:</strong> <span id="venta-cliente">&gt;&gt;[id_local]&gt;&gt;</span><br>
      <strong>Responsable:</strong> <span id="venta-vendedor">&gt;&gt;[responsable]&gt;&gt;</span><br>
    </div>

    <h2>Detalle de Venta</h2>
    <table class="detalle-table">
      <thead>
        <tr>
          <th>Categoria</th>
          <th>Cumplimiento Colgate</th>
          <th>Cumplimiento Elmex</th>
          <th>Cumplimiento Planograma</th>
        </tr>
      </thead>
      <tbody id="detalle-table-body">
        <!-- Aquí se insertarán las filas del detalle de venta -->
      </tbody>
    </table>

    <div class="total">
      <strong>Diferencia:</strong> <span id="total-final">&gt;&gt;[DIF+/-PNG]&gt;&gt;</span>
    </div>
  </div>

  <script>
    // Función para rellenar la tabla de detalle
    function agregarDetalle(producto, cantidad, precioUnitario, subtotal) {
      const tablaBody = document.getElementById("detalle-table-body");
      const newRow = tablaBody.insertRow();

      const cellProducto = newRow.insertCell();
      const cellCantidad = newRow.insertCell();
      const cellPrecio = newRow.insertCell();
      const cellSubtotal = newRow.insertCell();

      cellProducto.textContent = producto;
      cellCantidad.textContent = cantidad;
      cellPrecio.textContent = precioUnitario;
      cellSubtotal.textContent = subtotal;
    }

    // Función para cargar los datos desde AppSheet (placeholder)
    function cargarDatos() {
      // **IMPORTANTE:**  Este es un placeholder. La forma real de obtener los datos
      // de AppSheet depende de cómo hayas configurado tu integración y
      // de cómo AppSheet te permite exportar o acceder a los datos.

      // **OPCIÓN 1: Si puedes generar un archivo JSON desde AppSheet:**
      // 1. Genera un archivo JSON que contenga la información de la venta
      //    y el detalle.
      // 2. Usa la función `fetch` para cargar el archivo JSON:
      //    fetch('tu_archivo.json')
      //      .then(response => response.json())
      //      .then(data => {
      //        // Llenar el HTML con los datos del JSON (ver más abajo)
      //      });

      // **OPCIÓN 2: Si AppSheet te permite ejecutar un script que genere este HTML
      //    directamente:**
      //   Puedes inyectar los datos directamente en las variables de Javascript
      //   sin necesidad de fetch.  Por ejemplo:
      //   const ventaId = "[ID_VENTA]"; // AppSheet reemplaza esto con el valor real
      //   const ventaFecha = "[FECHA_VENTA]";

      // **EJEMPLO DE CÓMO LLENAR EL HTML CON LOS DATOS (ya sea desde JSON o variables):**

      // Datos de la Venta (reemplaza con tus datos reales)
      const ventaId = &gt;&gt;[ID_encuesta]&gt;&gt; // Reemplazar con tu valor real
      const ventaFecha = &gt;&gt;[FECHA]&gt;&gt; // Reemplazar con tu valor real
      const ventaCliente = &gt;&gt;[id_local]&gt;&gt; // Reemplazar con tu valor real
      const ventaVendedor = &gt;&gt;[responsable]&gt;&gt; // Reemplazar con tu valor real

      // Datos del Detalle (reemplaza con tus datos reales)
      const detalles = [
        { producto: "Producto A", cantidad: 2, precioUnitario: 10, subtotal: 20 },
        { producto: "Producto B", cantidad: 1, precioUnitario: 15, subtotal: 15 },
        { producto: "Producto C", cantidad: 3, precioUnitario: 5, subtotal: 15 }
      ];

      // Llenar los datos en el HTML
      document.getElementById("venta-id").textContent = ventaId;
      document.getElementById("venta-fecha").textContent = ventaFecha;
      document.getElementById("venta-cliente").textContent = ventaCliente;
      document.getElementById("venta-vendedor").textContent = ventaVendedor;
      document.getElementById("total-final").textContent = ventaTotal;

      // Llenar la tabla de detalle
      detalles.forEach(item => {
        agregarDetalle(item.producto, item.cantidad, item.precioUnitario, item.subtotal);
      });
    }

    // Cargar los datos al cargar la página
    window.onload = cargarDatos;
  </script>
</body>
</html>
